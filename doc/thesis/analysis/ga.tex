\section{Genetic Algorithms}
\label{sec:ga-analysis}

Table~\ref{table:basic-ga-results} and Table~\ref{table:rga-results} provide a summary of the results from the basic GA, and RGA experiments respectively. Each experiment in the results table was run 30 times.

\begin{table}
	\centering
	\begin{tabular}{ | >{\bfseries}c | c | c | c | c | c | c | }
		\hline
		Experiment Set & 1 & 2 & 3 & 4 & 5 & 6 \\ \hline
		Best RMSD & 1.2471 & 1.1880 & 1.1173 & 1.2349 & \textbf{1.0533} & 1.2287 \\ \hline
		Averge Best RMSD & 1.3518 & 1.3610 & \textbf{1.2942} & 1.3658 & 1.3044 & 1.3294 \\ \hline
	\end{tabular}
	\caption{Basic GA Results}
	\label{table:basic-ga-results}
\end{table}

\begin{table}
	\centering
	\begin{tabular}{ | >{\bfseries}c | c | c | c | c | c | c | c | c | }
		\hline
		Experiment Set & 1 & 2 & 3 & 4 \\ \hline
		Avg. Num. Generations & 61 & 73 & 86 & 106 \\ \hline
		Best RMSD & 1.1297 & 1.1174 & 1.0388 & \textbf{0.9649} \\ \hline
		Average Best RMSD & 1.2532 & 1.2468 & 1.2252 & 1.2149 \\ \hline
	\end{tabular}
	\\
	\vspace{3 mm}
	\begin{tabular}{ | >{\bfseries}c | c | c | c | c | c | c | c | c | }
		\hline
		Experiment Set & 5 & 6 & 7 & 8 \\ \hline
		Avg. Num. Generations & 72 & 83 & 100 & 133 \\ \hline
		Best RMSD & 1.1170 & 1.0012 & 1.0353 & 0.9992 \\ \hline
		Average Best RMSD & 1.2229 & 1.2119 & \textbf{1.1808} & 1.1856 \\ \hline
	\end{tabular}
	\caption{RGA Results}
	\label{table:rga-results}
\end{table}

The Mann-Whitney U test~\cite{mcknight2010mann} is a nonparametric test to determine if two groups are equivalent without assuming the groups have a normal distribution. Mann-Whitney U tests were performed on the results of the basic GA, and RGA experiment sets. The results of the basic GA experiments showed very little statistical significance. Experiments 3 and 5 show the best statistical performance over the other experiments which coincides with these experiments having the best fitness and average fitness scores. The results of the RGA experiments revealed that experiment 8 was able to perform statistically better than the other experiments. Experiments 3, 4, 5, 6, and 7 show little statistical difference and experiments 1, and 2 performed the worst. A comparison of the basic GA, and RGA experiments showed that the RGA performed statistically better than the basic GA.

A closer look at the data revealed that the basic GA experiments were converging early on local optima. The RGA experiments initially converged on similar optima but were able to find new optima after each restarting phase. Figure~\ref{fig:rga-generational-data} shows what a typical RGA run looks like at each generation. One would notice that there are several \textit{spikes} in the graph where the average fitness jumps. These \textit{spikes} represent a \textit{restart} in the population. During each \textit{restart} the average fitness of the population is disrupted but the fitness quickly improved showing an overall downward trend.

The number of generations in each RGA run varied based on when the population converged. Table~\ref{table:rga-results} contains the average number of generations each run had for each experiment.

At first it may seem biased that the RGA was able to find a better candidate solution than the GA because it was allowed to see more unique individuals and ran for more generations but the GA had some pitfalls when it was allowed the same privileges. Increasing the size of the GA's population had little affect on its ability to find improved candidate solutions. Increasing the number of generations for the GAs also did not affect the solutions. The GA runs would typically converge quickly and become stuck in a local optimum. Figure~\ref{fig:ga-generational-data-avg} shows the average best fitness for GA experiment 3.

The experiments that produced the best candidate solutions for both the GA, and RGA were experiments that contained a crossover rate of 70\% and a mutation rate of 30\% compared to the other experiments that contained a crossover rate of 80\% and a mutation rate of 20\%. Since the higher mutation rate performed better than the higher crossover rate this may indicate that the algorithms favoured receiving new information, through exploration, than exploiting the information already contained within the population. Using a higher mutation rate may also indicate that the problem is better suited to be solved using a less discrete search method such as PSO since the candidate solutions operate on a continuous space.

The best candidate solution found by the RGA can be seen in Figure~\ref{fig:rga-best-exafs}. The \textit{humps} on the calculated EXAFS spectrum appear to be getting close to the experimental EXAFS spectrum except in a few instances. Where $k$ is between 7.5 and 10 the experimental EXAFS spectrum is more chaotic and the calculated EXAFS spectrum is having a tougher time conforming. The chaotic nature of the data may be due to the margin of error in collecting the experimental EXAFS spectrum. A future technique may be to smooth out the experimental EXAFS spectrum in order to get a more accurate RMSD comparison. Another structure refinement technique could be to reduce the range on $k$ for comparison. Comparing the RMSD between $k = [1,7.5]$ may produce improved results because the fitness function would contain fewer erroneous data points.

\begin{figure}
	\centering
	\begin{tikzpicture}
		\begin{axis}[
				width=14cm,
				height=6cm,
				grid=both,
				title={Best RGA Run},
				legend entries={Best,Average},
				xlabel={Generation},
				ylabel={Fitness (RMSD)}
			]

			\addplot[mark=x] table [col sep=comma,y index=1, x index=0] {data/rga-sample-run.csv};
			\addplot[mark=*] table [col sep=comma,y index=2, x index=0] {data/rga-sample-run.csv};

		\end{axis}
	\end{tikzpicture}
	\caption{Example Run of a Restarting Genetic Algorithm}
	\label{fig:rga-generational-data}
\end{figure}

\begin{figure}
	\centering
	\begin{tikzpicture}
		\begin{axis}[
				width=14cm,
				height=6cm,
				grid=both,
				title={GA Performance},
				legend entries={Average Best},
				xlabel={Generation},
				ylabel={Fitness (RMSD)}
			]

			\addplot[mark=x] table [col sep=comma,y index=1, x index=0] {data/best-experiment-averaged/ga.csv};

		\end{axis}
	\end{tikzpicture}
	\caption{Performance of GA Experiment 3}
	\label{fig:ga-generational-data-avg}
\end{figure}

\begin{figure*}
	\centering
	\begin{tikzpicture}
		\begin{axis}[
			width=14cm,
			height=6cm,
			grid=both,
			title={EXAFS Spectra Comparison in k space},
			legend entries={Experimental,Calculated},
			legend pos=south west,
			xlabel={$k \mathbin{/} A\textsuperscript{-1}$},
			ylabel={$EXAFS \chi k\textsuperscript{3}$}
		]

		\addplot[mark=x] table [col sep=comma,y index=1, x index=0] {data/rga-best-exafs-comparison.csv};
		\addplot[mark=*,mark size=1] table [col sep=comma,y index=2, x index=0] {data/rga-best-exafs-comparison.csv};

		\end{axis}
	\end{tikzpicture}
	\caption{Best OEC EXAFS Spectra Comparison from RGA}
	\label{fig:rga-best-exafs}
\end{figure*}