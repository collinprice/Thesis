\documentclass[10pt]{beamer}
\usetheme{CambridgeUS}
\usecolortheme{beaver}

\usepackage{pgfplots}
\usepackage{algorithm}
\usepackage{graphics}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{algorithm,algorithmic}

\begin{document}

\title[Modeling OEC using EXAFS]{Modeling Metal Protein Complexes from Experimental Extended X-ray Absorption Fine Structure using Evolutionary Algorithms}

\author[Price \and Houghten \and Vassiliev \and Bruce]{
	Collin Price
	\and
	Sheridan Houghten
	\and
	Sergey Vassiliev
	\and
	Doug Bruce
}
\institute{Brock University}

\begin{frame}
	\titlepage
\end{frame}

\section{Introduction}

\begin{frame}
	\frametitle{Outline}
	\tableofcontents
\end{frame}

\begin{frame}
	\frametitle{Cofactor}

	\begin{columns}[T]
		\begin{column}{.5\textwidth}
			\begin{itemize}
				\item ``Helper'' molecules
				\item Assist in biochemical transformations
				\item Non-protein chemical compound
				\item Exist within a protein
			\end{itemize}
		\end{column}
		\begin{column}{.5\textwidth}
			\begin{figure}
				\caption{Cofactor Examples}
				\includegraphics[width=1.0\textwidth,natwidth=1630,natheight=1620]{img/Succinate_Dehydrogenase_1YQ3_Electron_Carriers_Labeled.png}
			\end{figure}
		\end{column}
	\end{columns}
	
\end{frame}

\begin{frame}
	\frametitle{Oxygen-Evolving Complex (OEC)}

	\begin{columns}[T]
		\begin{column}{.5\textwidth}
			\begin{itemize}
				\item The water-oxidizing enzyme of photosystem II.
				\item Water-splitting complex.
				\item Exists in 5 states: $S_{0}$ to $S_{4}$.
				\item Splits $H_{2}O$ into hydrogen and oxygen.
				\item $S_{4}$ reacts with water to produce oxygen.
				\item Process is not completely understood.
				\item $S_{1}$ is examined in this work.
			\end{itemize}
		\end{column}
		\begin{column}{.5\textwidth}
			\begin{figure}
				\caption{Metalloenzyme core of the OEC}
				\includegraphics[width=1.0\textwidth,natwidth=620,natheight=485]{img/oec.png}
			\end{figure}
		\end{column}
	\end{columns}

\end{frame}

\begin{frame}
	\frametitle{Experimental Extended X-ray Absorption Fine Structure (EXAFS)}
	
	\begin{itemize}
		\item A method used to measure the absorption coefficient of a material as a function of energy.
		\item X-ray is tuned to have the same wavelength as the target atom.
			\begin{itemize}
				\item In the case of the OEC we targeted the four Manganese atoms.
			\end{itemize}
		\item X-ray reacts with target atom causing the atom to lose an electron and interact with neighbouring atoms.
		\item Fluorescence energies are emitted and measured.
	\end{itemize}

\end{frame}

\begin{frame}
	\frametitle{Experimental EXAFS Spectra}

	\begin{figure}
		\begin{tikzpicture}
		  \begin{axis}[
		    width=12cm,
		    height=6cm,
		    grid=both,
		    title={EXAFS Spectra in k space},
		    legend entries={Experimental},
		    % legend pos=south east,
		    xlabel={$k \mathbin{/} A\textsuperscript{-1}$},
		    ylabel={$EXAFS \chi k\textsuperscript{3}$}
		  ]

		  \addplot[mark=x] table [col sep=comma,y index=1, x index=0] {results/best_run/for_chart.csv};

		  \end{axis}
		\end{tikzpicture}
		\caption{EXAFS Spectra of OEC in $S_{1}$}
	\end{figure}

\end{frame}

\begin{frame}
	\frametitle{Structure Refinement Problem}

	\begin{itemize}
		\item EXAFS spectra provides limited information about neighbouring atoms.
		\item We would like to know the 3-dimensional positions of each atom relative to each other.
		\item EXAFS spectra can be generated in simulations.
		\item If we match the calculated EXAFS spectra with the experimental EXAFS spectra it is likely we found the correct configuration.
		\item Goal is to minize the differences between spectra.
	\end{itemize}

\end{frame}

\begin{frame}
	\frametitle{Example Spectra Comparison}

	\begin{figure}
		\begin{tikzpicture}
		  \begin{axis}[
		    width=12cm,
		    height=6cm,
		    grid=both,
		    title={EXAFS Spectra in k space},
		    legend entries={Experimental,Calculated},
		    % legend pos=south east,
		    xlabel={$k \mathbin{/} A\textsuperscript{-1}$},
		    ylabel={$EXAFS \chi k\textsuperscript{3}$}
		  ]

		  \addplot[mark=x] table [col sep=comma,y index=1, x index=0] {results/best_run/for_chart.csv};
		  \addplot[mark=*,mark size=1,color=red] table [col sep=comma,y index=2, x index=0] {results/best_run/for_chart.csv};

		  \end{axis}
		\end{tikzpicture}
		\caption{OEC EXAFS Spectra Comparison}
	\end{figure}

\end{frame}

\section{Previous Work}

\begin{frame}
	\frametitle{Previous Work}

	\begin{itemize}
		\item A model of the oxygen-evolving center of photosystem II predicted by structural refinement based on EXAFS simulations
			\begin{itemize}
				\item \textit{Sproviero, Eduardo M and Gasc{\'o}n, Jos{\'e} A and McEvoy, James P and Brudvig, Gary W and Batista, Victor S}
			\end{itemize}
		\item $S_{1}$-state model of the $O_{2}$-evolving complex of photosystem II
			\begin{itemize}
				\item \textit{Luber, Sandra and Rivalta, Ivan and Umena, Yasufumi and Kawakami, Keisuke and Shen, Jian-Ren and Kamiya, Nobuo and Brudvig, Gary W and Batista, Victor S}
			\end{itemize}
		\item Density functional theory quantum mechanics and molecular mechanics hybrid (DFT-QM/MM)
		\item Monte Carlo method (R-QM/MM)
		\item Previous techniques would converge on local minima.
	\end{itemize}

\end{frame}

\section{Methodology}

\subsection{Problem Encoding}

\begin{frame}
	\frametitle{Problem Encoding}

	\begin{itemize}
		\item Set of 3-dimensional coordinates in space, where each position is assigned to a specific atom in the atomic structure.
		\item Entire OEC atomic structure contains 1269 atoms.
		\item EXAFS calculations only require 79 specific atoms.
		\item The units of measurement for each atom position are measured in Angstroms (\AA).
		\item Two representations used.
	\end{itemize}

\end{frame}

\begin{frame}
	\frametitle{Problem Encoding}

	\begin{columns}[T]
		\begin{column}{.5\textwidth}
			
			\begin{figure}
				\centering
				\begin{tabular}{ | l  l  l | }
					\hline
					X & Y & Z \\ \hline
					14.451 & -13.346 & 1.133 \\ \hline
					15.336 & -13.488 & 2.014 \\ \hline
					13.005 & -13.364 & 1.452 \\ \hline
					0.019 & 0.011 & 0.045 \\ \hline
					... & ... & ... \\ \hline
				\end{tabular}
				\caption{Representation 1}
			\end{figure}

		\end{column}
		\begin{column}{.5\textwidth}
			
			\begin{figure}
				\centering
				\begin{tabular}{ | l  l | }
					\hline
					X$_{0}$ & 14.451 \\ \hline
					Y$_{0}$ & -13.346 \\ \hline
					Z$_{0}$ & 1.133 \\ \hline
					X$_{1}$ & 15.336 \\ \hline
					Y$_{1}$ & -13.488 \\ \hline
					Z$_{1}$ & 2.014 \\ \hline
					X$_{2}$ & 13.005 \\ \hline
					... & ... \\ \hline
				\end{tabular}
				\caption{Representation 2}
			\end{figure}

		\end{column}
	\end{columns}
\end{frame}

\subsection{Population Generation}

\begin{frame}
	\frametitle{Population Generation}

	Method 1

	\begin{itemize}
		\item Initial OEC atomic structure came from the crystallographic photosystem II structure in the Protein Data Bank.
		\item Randomly moving each atom produced too many unusable configurations.
		\item Needed to generate feasible structures for starting GA population.
		\item Used a molecular dynamics simulation to obtain these structures (NAMD).
		\item Produced 10 000 atomic structures.
		\item Evaluated each atomic structure and kept the top 300.
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{Population Generation}

	Method 2

	\begin{itemize}
		\item Initialize population based on seed atomic structure.
		\item Each atomic position within the atomic structure is randomly shifted.
	\end{itemize}

	\begin{figure}
		\centering
		\begin{tabular}{ | l | }
			\hline
			14.451 \\ \hline
			-13.346 \\ \hline
			1.133 \\ \hline
			15.336 \\ \hline
			-13.488 \\ \hline
			2.014 \\ \hline
			13.005 \\ \hline
			... \\ \hline
		\end{tabular}
		\qquad$\implies$\qquad
		\begin{tabular}{ | l | }
			\hline
			14.494 \\ \hline
			-13.370 \\ \hline
			1.132 \\ \hline
			15.295 \\ \hline
			-13.518 \\ \hline
			2.009 \\ \hline
			13.018 \\ \hline
			... \\ \hline
		\end{tabular}
		\caption{Randomly shifting atomic positions by 0.05\AA}
		\label{fig:random-shift}
	\end{figure}

\end{frame}

\subsection{Genetic Operators}

\begin{frame}
	\frametitle{Operators}

	\begin{itemize}
		\item Crossover operator
			\begin{itemize}
				\item One-point crossover
				\item Least destructive to the individuals
			\end{itemize}
		\item Mutation operator
			\begin{itemize}
				\item Single atomic coordinate is randomly moved my 0.05\AA using Euclidean distance.
				\item Tested moving atomic coordinates by 0.001\AA, 0.005\AA, 0.01\AA, 0.025\AA, 0.05\AA, 0.1\AA, 0.5\AA, 1\AA, and 5\AA.
				\item 0.05\AA\ was chosen because it produced at least a 1\% change in fitness for all chemical elements.
			\end{itemize}
		\item Selection operator
			\begin{itemize}
				\item 3-tournament selection
			\end{itemize}
	\end{itemize}

\end{frame}

\subsection{Fitness}

\begin{frame}
	\frametitle{Fitness}

	\begin{itemize}
		\item The goal of the experiment is to find an atomic structure that generates the same EXAFS spectra as the experimental EXAFS spectra.
		\item FEFF6 is used to simulate an XAFS experiment.
		\item IFEFFIT does post processing of the simulated EXAFS spectra.
		\item IFEFFIT was developed at CARS, the Consortium for Advanced Radiation Sources at The University of Chicago.
		\item The root-mean-square deviations (RMSD) is used to calculate the difference between the experimental and calculated EXAFS spectra.
	\end{itemize}

	\begin{equation}
		RMSD = \sqrt{\frac{\sum_{t=1}^{n} \left ( x_{1,t}-x_{2,t} \right )^{2}}{n}}
	\end{equation}

\end{frame}

\begin{frame}
	\frametitle{Example Spectra Comparison}

	\begin{figure}
		\begin{tikzpicture}
		  \begin{axis}[
		    width=12cm,
		    height=6cm,
		    grid=both,
		    title={EXAFS Spectra in k space},
		    legend entries={Experimental,Calculated},
		    % legend pos=south east,
		    xlabel={$k \mathbin{/} A\textsuperscript{-1}$},
		    ylabel={$EXAFS \chi k\textsuperscript{3}$}
		  ]

		  \addplot[mark=x] table [col sep=comma,y index=1, x index=0] {results/best_run/for_chart.csv};
		  \addplot[mark=*,mark size=1,color=red] table [col sep=comma,y index=2, x index=0] {results/best_run/for_chart.csv};

		  \end{axis}
		\end{tikzpicture}
		\caption{OEC EXAFS Spectra Comparison}
	\end{figure}

\end{frame}

\section{Experiments}

\subsection{Genetic Algorithm and Restarting Genetic Algorithm}

\begin{frame}
	\frametitle{Genetic Algorithm (GA)}

	\begin{itemize}
		\item Shown success in past studies in finding low-energy protein conformations.
		\item Higher potential of avoiding local minima.
		\item Algorithm is able to produce a population of candidate solutions for future examination.
	\end{itemize}

\end{frame}

\begin{frame}
	\frametitle{Restarting Genetic Algorithm (RGA)}

	\begin{itemize}
		\item Variation of the Recentering-Restarting Genetic Algorithm.
		\item Used to maintain diversity within the population.
		\item Genetic Algorithm is run until the population has reached a set convergence rate.
		\item Duplicate individuals are removed from the population and new individuals are injected into the population.
	\end{itemize}

	\begin{algorithm}[H]
		\caption{Restarting the population}
		\begin{algorithmic}[1]

		\IF{population has converged to minimum diversity}
		  \STATE remove all duplicate individuals;
		  \WHILE{population not full}
		    \STATE insert random draw from generated individuals into population;
		  \ENDWHILE
		\ENDIF

		\end{algorithmic}
	\end{algorithm}

\end{frame}

\begin{frame}
	\frametitle{Experiment Setup}

	\begin{table}
		\caption{System Parameters used in GA and RGA}
		\begin{tabular}{ | l | r | }
		  \hline
		    Settings & Values \\ \hline \hline
		    Runs & 30 \\ \hline
		    Generations & Max. 30, Until Converged \\ \hline
		    Population Size & 50 \\ \hline
		    Crossover Rate & 80, 70 \\ \hline
		    Mutation rate & 10, 20, 30 \\ \hline
		    Elitism & True, False \\ \hline
		    Number of restart attempts (RGA) & 3, 5 \\ \hline
		    \shortstack{Max convergence percentage \\ before restarting (RGA)} & 5\%, 10\% \\ \hline
		\end{tabular}
	\end{table}
\end{frame}

\begin{frame}
	\frametitle{Experiment Setup}

	\begin{itemize}
		\item Initial population: molecular dynamics simulation.
		\item Representation 1: list of 3-dimensional coordinates.
	\end{itemize}

\end{frame}

\begin{frame}
	% \frametitle{Results from GA and RGA Experiments}

	\begin{table}
	  \caption{Results from GA Experiments}
	  \small
	  \begin{tabular}{ | l | l | l | l | l | l | l | l | l | l | }
	    \hline
	    Gen. & Crossover & Mutation & Elitism & Best & Avg. Best \\ \hline \hline
	    30 & 80\% & 20\% & False & 1.2471 & 1.3518 \\ \hline
	    30 & 80\% & 10\% & False & 1.1880 & 1.3610 \\ \hline
	    30 & 70\% & 30\% & False & 1.1173 & 1.2942 \\ \hline
	    
	    30 & 80\% & 20\% & True & 1.2287 & 1.3294 \\ \hline
	    30 & 80\% & 10\% & True & 1.2349 & 1.3658 \\ \hline
	    30 & 70\% & 30\% & True & 1.0533 & 1.3044 \\ \hline
	  \end{tabular}
	\end{table}

	\begin{table}
	  \caption{Results from RGA Experiments}
	  \small
	  \begin{tabular}{ | l | l | l | l | l | l | l | l | l | l | }
	    \hline
	    Gen. & Xover & Mut. & Elitism & Conv. Rate & Restarting & Best & Avg. Best \\ \hline \hline
	     & 80\% & 20\% & True & 10\% & 3 &  &  \\ \hline%1
	     & 80\% & 20\% & True & 5\% & 3 &  &  \\ \hline%2
	     & 80\% & 20\% & True & 10\% & 5 &  &  \\ \hline%3
	     & 80\% & 20\% & True & 5\% & 5 &  &  \\ \hline%4

	     & 70\% & 30\% & True & 10\% & 3 &  &  \\ \hline%5
	     & 70\% & 30\% & True & 5\% & 3 &  &  \\ \hline%6
	     & 70\% & 30\% & True & 10\% & 5 &  &  \\ \hline%7
	     & 70\% & 30\% & True & 5\% & 5 &  &  \\ \hline%8
	  \end{tabular}
	\end{table}

\end{frame}

% \begin{frame}
% 	\frametitle{Results from GA and RGA Experiments}

% 	\begin{table}
% 	  % \caption{Results from GA Experiments}
% 	  \begin{tabular}{ | l | l | l |}
% 	    \hline
% 	    Settings & GA & RGA \\ \hline \hline
% 	    Gen. & 30 & 67 \\ \hline
% 	    Crossover & 70\% & 70\% \\ \hline
% 	    Mutation & 30\% & 30\% \\ \hline
% 	    Elitism & True & True \\ \hline
% 	    Conv. Rate & - & 5\% \\ \hline
% 	    Restarting Count & - & 5 \\ \hline
% 	    Avg. Best RMSD & 1.2591 & 1.1998 \\ \hline
% 	    Best RMSD & 1.1452 & 1.0877 \\ \hline
% 	  \end{tabular}
% 	\end{table}

% \end{frame}

\begin{frame}
	\frametitle{Analysis}

	Genetic Algorithm

	\begin{itemize}
		\item Mann-Whitney U tests performed.
		\item Experiments using a crossover rate of 70\% and a mutation rate of 30\% performed statistically better than others.
		\item May indicate problem prefers exploration over exploitation.
	\end{itemize}

	Restarting Genetic Algorithm
	
	\begin{itemize}
		\item Mann-Whitney U tests performed.
		\item RGA experiments performed statistically better than all GA experiments.
		\item Experiment with the highest number of restarts and lowest convergence criteria performed statistically better than others.
		\item Results show GA experiments converging early on local optima.
	\end{itemize}

\end{frame}

\begin{frame}
	\frametitle{Best RGA Spectra}

	\begin{figure}
		\begin{tikzpicture}
		  \begin{axis}[
		    width=12cm,
		    height=6cm,
		    grid=both,
		    title={EXAFS Spectra in k space},
		    legend entries={Experimental,Calculated},
		    % legend pos=south east,
		    xlabel={$k \mathbin{/} A\textsuperscript{-1}$},
		    ylabel={$EXAFS \chi k\textsuperscript{3}$}
		  ]

		  \addplot[mark=x] table [col sep=comma,y index=1, x index=0] {results/best_run/for_chart.csv};
		  \addplot[mark=*,mark size=1,color=red] table [col sep=comma,y index=2, x index=0] {results/best_run/for_chart.csv};

		  \end{axis}
		\end{tikzpicture}
		\caption{OEC EXAFS Spectra Comparison}
	\end{figure}

\end{frame}

\begin{frame}
	\frametitle{Results}

	\begin{figure}
		\begin{tikzpicture}
		  \begin{axis}[
		    grid=both,
		    title={Best RGA Run},
		    legend entries={Best,Average},
		    xlabel={Generations},
		    ylabel={RMSD}
		  ]

		  \addplot[mark=x,color=red] table [col sep=comma,y index=1, x index=0] {results/best_run/results-fixed.csv};
		  \addplot[mark=*,color=blue] table [col sep=comma,y index=2, x index=0] {results/best_run/results-fixed.csv};

		  \end{axis}
		\end{tikzpicture}
		\caption{Example of a Restarting Genetic Algorithm}
	\end{figure}

\end{frame}

% \begin{frame}
% 	\frametitle{Results}

% 	\begin{columns}[T]
% 		\begin{column}{.5\textwidth}
% 			\begin{itemize}
% 				\item GA and RGA were able to find a better solution than previously found.
% 				\item RGA was able to find a better solution than GA.
% 			\end{itemize}
% 		\end{column}
% 		\begin{column}{.5\textwidth}
% 			\begin{table}
% 				\caption{Comparison of Results}
% 				\begin{tabular}{ | l | l | l | l | l | }
% 				  \hline
% 				    Algorithm & Best Results \\ \hline
% 				    DFT-QM/MM & 1.2643 \\ \hline
% 				    R-QM/MM & 1.2403 \\ \hline
% 				    GA & 1.1452 \\ \hline
% 				    RGA & \textbf{1.0877} \\ \hline
% 				\end{tabular}
% 			\end{table}
% 		\end{column}
% 	\end{columns}

% \end{frame}


\subsection{Post-Optimization: Differential Evolution and Particle Swarm Optimization}

\begin{frame}
	\frametitle{Post-Optimization}

	\begin{itemize}
		\item Results from GA and RGA were successful but we could do better.
		\item Convinced by guest speaker to try Particle Swarm Optimization.
		\item Convinced by fellow student to try Differential Evolution.
		\item Used the computational intelligence library, CILIB.
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{Particle Swarm Optimization (PSO) \& \,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\, Differential Evolution (DE)}

	\begin{itemize}
		\item Excel in continuous space problems.
		\item Offers more fluid movement through the search space.
		\item Still gain a population of candidate solutions.
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{Experiment Setup}

	\begin{itemize}
		\item Initial population: random.
		\item Representation 2: list of real numbers.
	\end{itemize}

	\begin{table}
		\caption{System Parameters used in GA and RGA}
		\begin{tabular}{ | l | r | }
		  \hline
		    Settings & Values \\ \hline \hline
		    Runs & 30 \\ \hline
		    Generations & 30 \\ \hline
		    Population Size & 50 \\ \hline
		    Initial Movement Radius & 0.05, 0.25 \\ \hline
		\end{tabular}
	\end{table}

\end{frame}

\begin{frame}
	\frametitle{Results}

	\begin{itemize}
		\item Initial RMSD from RGA experiment was 1.0877.
	\end{itemize}

	\begin{table}
		\caption{Local Search Results}
		\centering
		\begin{tabular}{ | l | l | l | l | l | }
		  \hline
		    Algorithm & Initial Movement Radius & Pop. Size & Gen. & Average Best \\ \hline \hline
		    PSO & $\pm$0.05\AA & 50 & 30 & 0.8976 \\ \hline
		    DE & $\pm$0.05\AA & 50 & 30 & \textbf{1.1354} \\ \hline
		    PSO & $\pm$0.25\AA & 50 & 30 & 1.2411 \\ \hline
		    DE & $\pm$0.25\AA & 50 & 30 & 1.7220 \\ \hline
		\end{tabular}
	\end{table}

	\begin{itemize}
		\item DE was not able to improve upon previously found candidate solutions.
	\end{itemize}

\end{frame}

\begin{frame}
	\frametitle{Analysis}

\end{frame}

\begin{frame}
	\frametitle{Best Result}

	\begin{figure}
		\begin{tikzpicture}
		  \begin{axis}[
		    width=12cm,
		    height=6cm,
		    grid=both,
		    title={EXAFS Spectra in k space},
		    legend entries={Experimental, RGA Calculated, PSO Calculated},
		    % legend pos=south east,
		    xlabel={$k \mathbin{/} A\textsuperscript{-1}$},
		    ylabel={$EXAFS \chi k\textsuperscript{3}$}
		  ]

		  \addplot[mark=x] table [col sep=comma,y index=2, x index=0] {results/pso_results/pso-100.csv};
		  \addplot[mark=-,mark size=1,color=red] table [col sep=comma,y index=2, x index=0] {results/best_run/for_chart.csv};
		  \addplot[mark=*,mark size=1,color=blue] table [col sep=comma,y index=1, x index=0] {results/pso_results/pso-100.csv};

		  \end{axis}
		\end{tikzpicture}
		\caption{OEC EXAFS Spectra Comparison for PSO Post-Optimization}
	\end{figure}

\end{frame}

% \begin{frame}
% 	\frametitle{Final Results}

% 	\begin{table}
% 		\caption{Comparison of Results}
% 		\begin{tabular}{ | l | l | l | l | l | }
% 		  \hline
% 		    Algorithm & Best Results \\ \hline
% 		    DFT-QM/MM & 1.2643 \\ \hline
% 		    R-QM/MM & 1.2403 \\ \hline
% 		    GA & 1.1452 \\ \hline
% 		    RGA & 1.0877 \\ \hline
% 		    PSO & \textbf{0.7287} \\ \hline
% 		\end{tabular}
% 	\end{table}

% \end{frame}

\subsection{Differential Evolution and Particle Swarm Optimization}

\begin{frame}
	\frametitle{Experimental Design}

\end{frame}

\begin{frame}
	\frametitle{Parameters}

\end{frame}

\begin{frame}
	\frametitle{Results}

\end{frame}

\begin{frame}
	\frametitle{Analysis}

\end{frame}

\begin{frame}
	\frametitle{Comparison}

	\begin{table}
		\caption{Comparison of Results}
		\begin{tabular}{ | l | l | l | l | l | }
		  \hline
		    Algorithm & Best Results \\ \hline
		    DFT-QM/MM & 1.2643 \\ \hline
		    R-QM/MM & 1.2403 \\ \hline
		    GA & 1.1452 \\ \hline
		    RGA & 1.0877 \\ \hline
		    Post-Op PSO & 0.7287 \\ \hline
		    Post-Op DE & 1.0877 \\ \hline
		    PSO & 0.7287 \\ \hline
		    DE & 1.0877 \\ \hline
		\end{tabular}
	\end{table}

\end{frame}

\subsection{Subset Testing}

\begin{frame}
	\frametitle{Subset Testing}

	\begin{columns}[T]
		\begin{column}{.5\textwidth}
			\begin{itemize}
				\item Individuals contain 79 atoms.
				\item Wanted reduce the search space.
				\item Tested keeping certain chemical elements rigid during experiments.
			\end{itemize}
		\end{column}
		\begin{column}{.5\textwidth}
			\begin{table}
				\caption{Chemical Element Breakdown of OEC}
				\begin{tabular}{ | l | l | }
				  \hline
				    Element & Count \\ \hline
				    Mn & 4 \\ \hline
				    Ca & 1 \\ \hline
				    O & 26 \\ \hline
				    C & 14 \\ \hline
				    N & 6 \\ \hline
				    H & 28 \\ \hline
				    Total & 79 \\ \hline
				\end{tabular}
			\end{table}
		\end{column}
	\end{columns}

\end{frame}

\begin{frame}
	\frametitle{GA Parameters}

	\begin{table}
		\caption{GA Subset Parameters}
		\begin{tabular}{ l r }
		  \hline
		    Runs & 10 \\
		    Population size & 50 \\
		    Crossover rate & 0.7 \\
		    Mutation rate & 0.3 \\
		    Elitism & True \\
		    Number of restart attempts & 5 \\
		    Max convergence percentage before restarting & 5\% \\
		  \hline
		\end{tabular}
	\end{table}

\end{frame}

\begin{frame}
	\frametitle{Results}

	\begin{table}
		\caption{Results from subsets experiments}
		\begin{tabular}{ | l | l | l | l | }
			\hline
			Flexible Atoms & Rigid Atoms & Best & Average \\ \hline \hline
			Mn, Ca, C, O, N, H & None & 1.1998 & 1.2580 \\ \hline
			Mn, Ca, C, O, N & H & \textbf{1.1697} & 1.2621 \\ \hline
			Mn, Ca, C & O, N, H & 2.4413 & N/A \\ \hline
			Mn, Ca, O & C, N, H & 1.2531 & N/A \\ \hline
			Mn, Ca, N & C, O, H & 2.4881 & N/A \\ \hline
			Mn, Ca, C, O & N, H & \textbf{1.1648} & N/A \\ \hline
			Mn, Ca, C, N & O, H & 2.5143 & 2.5649 \\ \hline
			Mn, Ca, O, N & C, H & N/A & N/A \\ \hline
			Mn, Ca & C, O, N, H & 2.4916 & 2.5088 \\ \hline
		\end{tabular}
	\end{table}

	Note: N/A means there were too many invalid solutions.

\end{frame}

\section{Conclusion and Future Work}

% \begin{frame}
% 	\frametitle{Conclusion}

% 	\begin{columns}[T]
% 		\begin{column}{.6\textwidth}
% 			\begin{itemize}
% 				\item GA and RGA were able to find a better solution than previously found.
% 				\item RGA was able to find a better solution than GA.
% 			\end{itemize}
% 		\end{column}
% 		\begin{column}{.4\textwidth}
% 			\begin{table}
% 				\caption{Comparison of Results}
% 				\begin{tabular}{ | l | l | l | l | l | }
% 				  \hline
% 				    Algorithm & Best Results \\ \hline
% 				    DFT-QM/MM & 1.2643 \\ \hline
% 				    R-QM/MM & 1.2403 \\ \hline
% 				    GA & 1.1452 \\ \hline
% 				    RGA & 1.0877 \\ \hline
% 				    PSO & \textbf{0.7287} \\ \hline
% 				\end{tabular}
% 			\end{table}
% 		\end{column}
% 	\end{columns}

% \end{frame}

\begin{frame}
	\frametitle{Conclusion}

	\begin{itemize}
		\item ...
	\end{itemize}

\end{frame}

\begin{frame}
	\frametitle{Future Work}

	\begin{itemize}
		\item Attempt direct comparison of PSO and DE with GA and RGA.
		\item Perform another molecular dynamics simulation on best result found from experimentation.
		\item Incorporate force fields into the algorithms to guarantee chemically feasible atomic structures.
		\item Multi-objective optimization using RMSD and potential energy.
	\end{itemize}

\end{frame}

\begin{frame}
	
	\begin{center}
	\Huge Questions?
	\end{center}

\end{frame}

\end{document}